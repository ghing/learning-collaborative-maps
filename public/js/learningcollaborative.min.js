(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.LearningCollaborative = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _AppDispatcher=require("../dispatcher/AppDispatcher"),_AppDispatcher2=_interopRequireDefault(_AppDispatcher),_LearningCollaborativeConstants=require("../constants/LearningCollaborativeConstants"),_LearningCollaborativeConstants2=_interopRequireDefault(_LearningCollaborativeConstants),LearningCollaborativeActions={setSchools:function(e){_AppDispatcher2["default"].handleViewAction({actionType:_LearningCollaborativeConstants2["default"].SCHOOLS_SET,schools:e})},setAgencies:function(e){_AppDispatcher2["default"].handleViewAction({actionType:_LearningCollaborativeConstants2["default"].AGENCIES_SET,agencies:e})}};exports["default"]=LearningCollaborativeActions;
},{"../constants/LearningCollaborativeConstants":3,"../dispatcher/AppDispatcher":4}],2:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_leaflet=require("leaflet"),_leaflet2=_interopRequireDefault(_leaflet),_react=require("react"),_react2=_interopRequireDefault(_react),_SchoolStore=require("../stores/SchoolStore"),_SchoolStore2=_interopRequireDefault(_SchoolStore),_AgencyStore=require("../stores/AgencyStore"),_AgencyStore2=_interopRequireDefault(_AgencyStore),LearningCollaborativeMap=_react2["default"].createClass({displayName:"LearningCollaborativeMap",getInitialState:function(){return{schools:_SchoolStore2["default"].getAll(),agencies:_AgencyStore2["default"].getAll(),agencyColorScale:_AgencyStore2["default"].getColorScale()}},getDefaultProps:function(){return{center:[41.881832,-87.623177],initialZoom:13,markerOptions:{radius:2,fillColor:"#ff7800",color:"#000",weight:1,opacity:1,fillOpacity:.8}}},componentWillUnmount:function(){TodoStore.removeChangeListener(this._onChange),_AgencyStore2["default"].removeChangeListener(this._onChange)},render:function(){return _react2["default"].createElement("div",{ref:"mapContainer",className:"map-container-inner"})},componentDidMount:function(){_SchoolStore2["default"].addChangeListener(this._onChange),_AgencyStore2["default"].addChangeListener(this._onChange),this.state.schools.length&&this.state.agencies.length&&this._initializeMap()},componentDidUpdate:function(){this.state.schools.length&&this.state.agencies.length&&this._initializeMap()},_initializeMap:function(){var e=this,t=_leaflet2["default"].map(this.refs.mapContainer).setView(this.props.center,this.props.initialZoom);_leaflet2["default"].tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:'Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}).addTo(t);var o=_leaflet2["default"].geoJson(this.state.schools,{pointToLayer:function(t,o){var a=(0,_objectAssign2["default"])({},e.props.markerOptions),n=t.properties.programs,r=void 0,i=void 0;return n&&n.length&&(n.length>1?a.fillColor="black":(r=n[0].agency.split("/"),i=r[r.length-1],console.log(i),a.fillColor=_AgencyStore2["default"].getColorScale()(i))),_leaflet2["default"].circleMarker(o,a)},onEachFeature:function(e,t){t.bindPopup('<h2 class="school-name">'+e.properties.FacilityName+"</h2>")}}).addTo(t);t.fitBounds(o.getBounds())},_onChange:function(){this.setState({schools:_SchoolStore2["default"].getAll(),agencies:_AgencyStore2["default"].getAll()})}});exports["default"]=LearningCollaborativeMap;
},{"../stores/AgencyStore":6,"../stores/SchoolStore":7,"leaflet":"leaflet","object-assign":"object-assign","react":"react"}],3:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _keymirror=require("keymirror"),_keymirror2=_interopRequireDefault(_keymirror);exports["default"]=(0,_keymirror2["default"])({SCHOOLS_SET:null,AGENCIES_SET:null});
},{"keymirror":"keymirror"}],4:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_flux=require("flux"),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),AppDispatcher=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"handleViewAction",value:function(e){this.dispatch({source:"VIEW_ACTION",action:e})}}]),t}(_flux.Dispatcher);exports["default"]=new AppDispatcher;
},{"flux":"flux","object-assign":"object-assign"}],5:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.LearningCollaborativeMapApp=void 0;var _react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_xhrPromise=require("xhr-promise"),_xhrPromise2=_interopRequireDefault(_xhrPromise),_LearningCollaborativeActions=require("./actions/LearningCollaborativeActions"),_LearningCollaborativeActions2=_interopRequireDefault(_LearningCollaborativeActions),_LearningCollaborativeMap=require("./components/LearningCollaborativeMap"),_LearningCollaborativeMap2=_interopRequireDefault(_LearningCollaborativeMap),LearningCollaborativeMapApp=exports.LearningCollaborativeMapApp=function(e){var r=new _xhrPromise2["default"],a=new _xhrPromise2["default"];_reactDom2["default"].render(_react2["default"].createElement(_LearningCollaborativeMap2["default"],null),e.container),r.send({method:"GET",url:e.schoolsJSONURL}).then(function(e){_LearningCollaborativeActions2["default"].setSchools(e.responseText.features)}),a.send({method:"GET",url:e.agenciesJSONURL}).then(function(e){_LearningCollaborativeActions2["default"].setAgencies(e.responseText.features)})};
},{"./actions/LearningCollaborativeActions":1,"./components/LearningCollaborativeMap":2,"react":"react","react-dom":"react-dom","xhr-promise":"xhr-promise"}],6:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_d=require("d3"),_d2=_interopRequireDefault(_d),_events=require("events"),_AppDispatcher=require("../dispatcher/AppDispatcher"),_AppDispatcher2=_interopRequireDefault(_AppDispatcher),_LearningCollaborativeConstants=require("../constants/LearningCollaborativeConstants"),_LearningCollaborativeConstants2=_interopRequireDefault(_LearningCollaborativeConstants),CHANGE_EVENT="change",_agencies=[],_agencyColorScale=_d2["default"].scale.category20(),AgencyStore=(0,_objectAssign2["default"])({},_events.EventEmitter.prototype,{getAll:function(){return _agencies},getColorScale:function(){return _agencyColorScale},emitChange:function(){this.emit(CHANGE_EVENT)},addChangeListener:function(e){this.on(CHANGE_EVENT,e)},removeChangeListener:function(e){this.removeListener(CHANGE_EVENT,e)},dispatcherIndex:_AppDispatcher2["default"].register(function(e){var t=e.action,n=void 0;switch(t.actionType){case _LearningCollaborativeConstants2["default"].AGENCIES_SET:n=t.agencies,_agencies=n,_agencyColorScale.domain(_agencies.map(function(e){return e.properties.slug})),AgencyStore.emitChange()}return!0})});exports["default"]=AgencyStore;
},{"../constants/LearningCollaborativeConstants":3,"../dispatcher/AppDispatcher":4,"d3":"d3","events":8,"object-assign":"object-assign"}],7:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_events=require("events"),_AppDispatcher=require("../dispatcher/AppDispatcher"),_AppDispatcher2=_interopRequireDefault(_AppDispatcher),_LearningCollaborativeConstants=require("../constants/LearningCollaborativeConstants"),_LearningCollaborativeConstants2=_interopRequireDefault(_LearningCollaborativeConstants),CHANGE_EVENT="change",_schools=[],SchoolStore=(0,_objectAssign2["default"])({},_events.EventEmitter.prototype,{getAll:function(){return _schools},emitChange:function(){this.emit(CHANGE_EVENT)},addChangeListener:function(e){this.on(CHANGE_EVENT,e)},removeChangeListener:function(e){this.removeListener(CHANGE_EVENT,e)},dispatcherIndex:_AppDispatcher2["default"].register(function(e){var t=e.action,n=void 0;switch(t.actionType){case _LearningCollaborativeConstants2["default"].SCHOOLS_SET:n=t.schools,_schools=n,SchoolStore.emitChange()}return!0})});exports["default"]=SchoolStore;
},{"../constants/LearningCollaborativeConstants":3,"../dispatcher/AppDispatcher":4,"events":8,"object-assign":"object-assign"}],8:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,i,n,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[e],isUndefined(i))return!1;if(isFunction(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(isObject(i))for(s=Array.prototype.slice.call(arguments,1),o=i.slice(),n=o.length,r=0;n>r;r++)o[r].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var i;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(i=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},EventEmitter.prototype.removeListener=function(e,t){var i,n,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],s=i.length,n=-1,i===t||isFunction(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(i)){for(r=s;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){n=r;break}if(0>n)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],isFunction(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};
},{}]},{},[5])(5)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9zcmMvYWN0aW9ucy9MZWFybmluZ0NvbGxhYm9yYXRpdmVBY3Rpb25zLmpzIiwianMvc3JjL2NvbXBvbmVudHMvTGVhcm5pbmdDb2xsYWJvcmF0aXZlTWFwLmpzIiwianMvc3JjL2NvbnN0YW50cy9MZWFybmluZ0NvbGxhYm9yYXRpdmVDb25zdGFudHMuanMiLCJqcy9zcmMvZGlzcGF0Y2hlci9BcHBEaXNwYXRjaGVyLmpzIiwianMvc3JjL2xlYXJuaW5nY29sbGFib3JhdGl2ZS5qcyIsImpzL3NyYy9zdG9yZXMvQWdlbmN5U3RvcmUuanMiLCJqcy9zcmMvc3RvcmVzL1NjaG9vbFN0b3JlLmpzIiwibm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7XCJkZWZhdWx0XCI6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIF9BcHBEaXNwYXRjaGVyPXJlcXVpcmUoXCIuLi9kaXNwYXRjaGVyL0FwcERpc3BhdGNoZXJcIiksX0FwcERpc3BhdGNoZXIyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0FwcERpc3BhdGNoZXIpLF9MZWFybmluZ0NvbGxhYm9yYXRpdmVDb25zdGFudHM9cmVxdWlyZShcIi4uL2NvbnN0YW50cy9MZWFybmluZ0NvbGxhYm9yYXRpdmVDb25zdGFudHNcIiksX0xlYXJuaW5nQ29sbGFib3JhdGl2ZUNvbnN0YW50czI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQ29uc3RhbnRzKSxMZWFybmluZ0NvbGxhYm9yYXRpdmVBY3Rpb25zPXtzZXRTY2hvb2xzOmZ1bmN0aW9uKGUpe19BcHBEaXNwYXRjaGVyMltcImRlZmF1bHRcIl0uaGFuZGxlVmlld0FjdGlvbih7YWN0aW9uVHlwZTpfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQ29uc3RhbnRzMltcImRlZmF1bHRcIl0uU0NIT09MU19TRVQsc2Nob29sczplfSl9LHNldEFnZW5jaWVzOmZ1bmN0aW9uKGUpe19BcHBEaXNwYXRjaGVyMltcImRlZmF1bHRcIl0uaGFuZGxlVmlld0FjdGlvbih7YWN0aW9uVHlwZTpfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQ29uc3RhbnRzMltcImRlZmF1bHRcIl0uQUdFTkNJRVNfU0VULGFnZW5jaWVzOmV9KX19O2V4cG9ydHNbXCJkZWZhdWx0XCJdPUxlYXJuaW5nQ29sbGFib3JhdGl2ZUFjdGlvbnM7IiwiXCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e1wiZGVmYXVsdFwiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBfb2JqZWN0QXNzaWduPXJlcXVpcmUoXCJvYmplY3QtYXNzaWduXCIpLF9vYmplY3RBc3NpZ24yPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29iamVjdEFzc2lnbiksX2xlYWZsZXQ9cmVxdWlyZShcImxlYWZsZXRcIiksX2xlYWZsZXQyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xlYWZsZXQpLF9yZWFjdD1yZXF1aXJlKFwicmVhY3RcIiksX3JlYWN0Mj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCksX1NjaG9vbFN0b3JlPXJlcXVpcmUoXCIuLi9zdG9yZXMvU2Nob29sU3RvcmVcIiksX1NjaG9vbFN0b3JlMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TY2hvb2xTdG9yZSksX0FnZW5jeVN0b3JlPXJlcXVpcmUoXCIuLi9zdG9yZXMvQWdlbmN5U3RvcmVcIiksX0FnZW5jeVN0b3JlMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9BZ2VuY3lTdG9yZSksTGVhcm5pbmdDb2xsYWJvcmF0aXZlTWFwPV9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUNsYXNzKHtkaXNwbGF5TmFtZTpcIkxlYXJuaW5nQ29sbGFib3JhdGl2ZU1hcFwiLGdldEluaXRpYWxTdGF0ZTpmdW5jdGlvbigpe3JldHVybntzY2hvb2xzOl9TY2hvb2xTdG9yZTJbXCJkZWZhdWx0XCJdLmdldEFsbCgpLGFnZW5jaWVzOl9BZ2VuY3lTdG9yZTJbXCJkZWZhdWx0XCJdLmdldEFsbCgpLGFnZW5jeUNvbG9yU2NhbGU6X0FnZW5jeVN0b3JlMltcImRlZmF1bHRcIl0uZ2V0Q29sb3JTY2FsZSgpfX0sZ2V0RGVmYXVsdFByb3BzOmZ1bmN0aW9uKCl7cmV0dXJue2NlbnRlcjpbNDEuODgxODMyLC04Ny42MjMxNzddLGluaXRpYWxab29tOjEzLG1hcmtlck9wdGlvbnM6e3JhZGl1czoyLGZpbGxDb2xvcjpcIiNmZjc4MDBcIixjb2xvcjpcIiMwMDBcIix3ZWlnaHQ6MSxvcGFjaXR5OjEsZmlsbE9wYWNpdHk6Ljh9fX0sY29tcG9uZW50V2lsbFVubW91bnQ6ZnVuY3Rpb24oKXtUb2RvU3RvcmUucmVtb3ZlQ2hhbmdlTGlzdGVuZXIodGhpcy5fb25DaGFuZ2UpLF9BZ2VuY3lTdG9yZTJbXCJkZWZhdWx0XCJdLnJlbW92ZUNoYW5nZUxpc3RlbmVyKHRoaXMuX29uQ2hhbmdlKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIix7cmVmOlwibWFwQ29udGFpbmVyXCIsY2xhc3NOYW1lOlwibWFwLWNvbnRhaW5lci1pbm5lclwifSl9LGNvbXBvbmVudERpZE1vdW50OmZ1bmN0aW9uKCl7X1NjaG9vbFN0b3JlMltcImRlZmF1bHRcIl0uYWRkQ2hhbmdlTGlzdGVuZXIodGhpcy5fb25DaGFuZ2UpLF9BZ2VuY3lTdG9yZTJbXCJkZWZhdWx0XCJdLmFkZENoYW5nZUxpc3RlbmVyKHRoaXMuX29uQ2hhbmdlKSx0aGlzLnN0YXRlLnNjaG9vbHMubGVuZ3RoJiZ0aGlzLnN0YXRlLmFnZW5jaWVzLmxlbmd0aCYmdGhpcy5faW5pdGlhbGl6ZU1hcCgpfSxjb21wb25lbnREaWRVcGRhdGU6ZnVuY3Rpb24oKXt0aGlzLnN0YXRlLnNjaG9vbHMubGVuZ3RoJiZ0aGlzLnN0YXRlLmFnZW5jaWVzLmxlbmd0aCYmdGhpcy5faW5pdGlhbGl6ZU1hcCgpfSxfaW5pdGlhbGl6ZU1hcDpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1fbGVhZmxldDJbXCJkZWZhdWx0XCJdLm1hcCh0aGlzLnJlZnMubWFwQ29udGFpbmVyKS5zZXRWaWV3KHRoaXMucHJvcHMuY2VudGVyLHRoaXMucHJvcHMuaW5pdGlhbFpvb20pO19sZWFmbGV0MltcImRlZmF1bHRcIl0udGlsZUxheWVyKFwiaHR0cDovL3tzfS50aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZ1wiLHttYXhab29tOjE4LGF0dHJpYnV0aW9uOidNYXAgZGF0YSDCqSA8YSBocmVmPVwiaHR0cDovL29wZW5zdHJlZXRtYXAub3JnXCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzJ30pLmFkZFRvKHQpO3ZhciBvPV9sZWFmbGV0MltcImRlZmF1bHRcIl0uZ2VvSnNvbih0aGlzLnN0YXRlLnNjaG9vbHMse3BvaW50VG9MYXllcjpmdW5jdGlvbih0LG8pe3ZhciBhPSgwLF9vYmplY3RBc3NpZ24yW1wiZGVmYXVsdFwiXSkoe30sZS5wcm9wcy5tYXJrZXJPcHRpb25zKSxuPXQucHJvcGVydGllcy5wcm9ncmFtcyxyPXZvaWQgMCxpPXZvaWQgMDtyZXR1cm4gbiYmbi5sZW5ndGgmJihuLmxlbmd0aD4xP2EuZmlsbENvbG9yPVwiYmxhY2tcIjoocj1uWzBdLmFnZW5jeS5zcGxpdChcIi9cIiksaT1yW3IubGVuZ3RoLTFdLGNvbnNvbGUubG9nKGkpLGEuZmlsbENvbG9yPV9BZ2VuY3lTdG9yZTJbXCJkZWZhdWx0XCJdLmdldENvbG9yU2NhbGUoKShpKSkpLF9sZWFmbGV0MltcImRlZmF1bHRcIl0uY2lyY2xlTWFya2VyKG8sYSl9LG9uRWFjaEZlYXR1cmU6ZnVuY3Rpb24oZSx0KXt0LmJpbmRQb3B1cCgnPGgyIGNsYXNzPVwic2Nob29sLW5hbWVcIj4nK2UucHJvcGVydGllcy5GYWNpbGl0eU5hbWUrXCI8L2gyPlwiKX19KS5hZGRUbyh0KTt0LmZpdEJvdW5kcyhvLmdldEJvdW5kcygpKX0sX29uQ2hhbmdlOmZ1bmN0aW9uKCl7dGhpcy5zZXRTdGF0ZSh7c2Nob29sczpfU2Nob29sU3RvcmUyW1wiZGVmYXVsdFwiXS5nZXRBbGwoKSxhZ2VuY2llczpfQWdlbmN5U3RvcmUyW1wiZGVmYXVsdFwiXS5nZXRBbGwoKX0pfX0pO2V4cG9ydHNbXCJkZWZhdWx0XCJdPUxlYXJuaW5nQ29sbGFib3JhdGl2ZU1hcDsiLCJcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7XCJkZWZhdWx0XCI6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIF9rZXltaXJyb3I9cmVxdWlyZShcImtleW1pcnJvclwiKSxfa2V5bWlycm9yMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXltaXJyb3IpO2V4cG9ydHNbXCJkZWZhdWx0XCJdPSgwLF9rZXltaXJyb3IyW1wiZGVmYXVsdFwiXSkoe1NDSE9PTFNfU0VUOm51bGwsQUdFTkNJRVNfU0VUOm51bGx9KTsiLCJcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7XCJkZWZhdWx0XCI6ZX19ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX1mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihlLHQpe2lmKCFlKXRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTtyZXR1cm4hdHx8XCJvYmplY3RcIiE9dHlwZW9mIHQmJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHQ/ZTp0fWZ1bmN0aW9uIF9pbmhlcml0cyhlLHQpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHQmJm51bGwhPT10KXRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiK3R5cGVvZiB0KTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSx0JiYoT2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZihlLHQpOmUuX19wcm90b19fPXQpfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBfY3JlYXRlQ2xhc3M9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciByPTA7cjx0Lmxlbmd0aDtyKyspe3ZhciBuPXRbcl07bi5lbnVtZXJhYmxlPW4uZW51bWVyYWJsZXx8ITEsbi5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gbiYmKG4ud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLG4ua2V5LG4pfX1yZXR1cm4gZnVuY3Rpb24odCxyLG4pe3JldHVybiByJiZlKHQucHJvdG90eXBlLHIpLG4mJmUodCxuKSx0fX0oKSxfZmx1eD1yZXF1aXJlKFwiZmx1eFwiKSxfb2JqZWN0QXNzaWduPXJlcXVpcmUoXCJvYmplY3QtYXNzaWduXCIpLF9vYmplY3RBc3NpZ24yPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29iamVjdEFzc2lnbiksQXBwRGlzcGF0Y2hlcj1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIF9jbGFzc0NhbGxDaGVjayh0aGlzLHQpLF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsT2JqZWN0LmdldFByb3RvdHlwZU9mKHQpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9cmV0dXJuIF9pbmhlcml0cyh0LGUpLF9jcmVhdGVDbGFzcyh0LFt7a2V5OlwiaGFuZGxlVmlld0FjdGlvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZGlzcGF0Y2goe3NvdXJjZTpcIlZJRVdfQUNUSU9OXCIsYWN0aW9uOmV9KX19XSksdH0oX2ZsdXguRGlzcGF0Y2hlcik7ZXhwb3J0c1tcImRlZmF1bHRcIl09bmV3IEFwcERpc3BhdGNoZXI7IiwiXCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e1wiZGVmYXVsdFwiOmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLGV4cG9ydHMuTGVhcm5pbmdDb2xsYWJvcmF0aXZlTWFwQXBwPXZvaWQgMDt2YXIgX3JlYWN0PXJlcXVpcmUoXCJyZWFjdFwiKSxfcmVhY3QyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KSxfcmVhY3REb209cmVxdWlyZShcInJlYWN0LWRvbVwiKSxfcmVhY3REb20yPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0RG9tKSxfeGhyUHJvbWlzZT1yZXF1aXJlKFwieGhyLXByb21pc2VcIiksX3hoclByb21pc2UyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3hoclByb21pc2UpLF9MZWFybmluZ0NvbGxhYm9yYXRpdmVBY3Rpb25zPXJlcXVpcmUoXCIuL2FjdGlvbnMvTGVhcm5pbmdDb2xsYWJvcmF0aXZlQWN0aW9uc1wiKSxfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQWN0aW9uczI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQWN0aW9ucyksX0xlYXJuaW5nQ29sbGFib3JhdGl2ZU1hcD1yZXF1aXJlKFwiLi9jb21wb25lbnRzL0xlYXJuaW5nQ29sbGFib3JhdGl2ZU1hcFwiKSxfTGVhcm5pbmdDb2xsYWJvcmF0aXZlTWFwMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9MZWFybmluZ0NvbGxhYm9yYXRpdmVNYXApLExlYXJuaW5nQ29sbGFib3JhdGl2ZU1hcEFwcD1leHBvcnRzLkxlYXJuaW5nQ29sbGFib3JhdGl2ZU1hcEFwcD1mdW5jdGlvbihlKXt2YXIgcj1uZXcgX3hoclByb21pc2UyW1wiZGVmYXVsdFwiXSxhPW5ldyBfeGhyUHJvbWlzZTJbXCJkZWZhdWx0XCJdO19yZWFjdERvbTJbXCJkZWZhdWx0XCJdLnJlbmRlcihfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KF9MZWFybmluZ0NvbGxhYm9yYXRpdmVNYXAyW1wiZGVmYXVsdFwiXSxudWxsKSxlLmNvbnRhaW5lciksci5zZW5kKHttZXRob2Q6XCJHRVRcIix1cmw6ZS5zY2hvb2xzSlNPTlVSTH0pLnRoZW4oZnVuY3Rpb24oZSl7X0xlYXJuaW5nQ29sbGFib3JhdGl2ZUFjdGlvbnMyW1wiZGVmYXVsdFwiXS5zZXRTY2hvb2xzKGUucmVzcG9uc2VUZXh0LmZlYXR1cmVzKX0pLGEuc2VuZCh7bWV0aG9kOlwiR0VUXCIsdXJsOmUuYWdlbmNpZXNKU09OVVJMfSkudGhlbihmdW5jdGlvbihlKXtfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQWN0aW9uczJbXCJkZWZhdWx0XCJdLnNldEFnZW5jaWVzKGUucmVzcG9uc2VUZXh0LmZlYXR1cmVzKX0pfTsiLCJcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7XCJkZWZhdWx0XCI6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIF9vYmplY3RBc3NpZ249cmVxdWlyZShcIm9iamVjdC1hc3NpZ25cIiksX29iamVjdEFzc2lnbjI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2JqZWN0QXNzaWduKSxfZD1yZXF1aXJlKFwiZDNcIiksX2QyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2QpLF9ldmVudHM9cmVxdWlyZShcImV2ZW50c1wiKSxfQXBwRGlzcGF0Y2hlcj1yZXF1aXJlKFwiLi4vZGlzcGF0Y2hlci9BcHBEaXNwYXRjaGVyXCIpLF9BcHBEaXNwYXRjaGVyMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9BcHBEaXNwYXRjaGVyKSxfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQ29uc3RhbnRzPXJlcXVpcmUoXCIuLi9jb25zdGFudHMvTGVhcm5pbmdDb2xsYWJvcmF0aXZlQ29uc3RhbnRzXCIpLF9MZWFybmluZ0NvbGxhYm9yYXRpdmVDb25zdGFudHMyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0xlYXJuaW5nQ29sbGFib3JhdGl2ZUNvbnN0YW50cyksQ0hBTkdFX0VWRU5UPVwiY2hhbmdlXCIsX2FnZW5jaWVzPVtdLF9hZ2VuY3lDb2xvclNjYWxlPV9kMltcImRlZmF1bHRcIl0uc2NhbGUuY2F0ZWdvcnkyMCgpLEFnZW5jeVN0b3JlPSgwLF9vYmplY3RBc3NpZ24yW1wiZGVmYXVsdFwiXSkoe30sX2V2ZW50cy5FdmVudEVtaXR0ZXIucHJvdG90eXBlLHtnZXRBbGw6ZnVuY3Rpb24oKXtyZXR1cm4gX2FnZW5jaWVzfSxnZXRDb2xvclNjYWxlOmZ1bmN0aW9uKCl7cmV0dXJuIF9hZ2VuY3lDb2xvclNjYWxlfSxlbWl0Q2hhbmdlOmZ1bmN0aW9uKCl7dGhpcy5lbWl0KENIQU5HRV9FVkVOVCl9LGFkZENoYW5nZUxpc3RlbmVyOmZ1bmN0aW9uKGUpe3RoaXMub24oQ0hBTkdFX0VWRU5ULGUpfSxyZW1vdmVDaGFuZ2VMaXN0ZW5lcjpmdW5jdGlvbihlKXt0aGlzLnJlbW92ZUxpc3RlbmVyKENIQU5HRV9FVkVOVCxlKX0sZGlzcGF0Y2hlckluZGV4Ol9BcHBEaXNwYXRjaGVyMltcImRlZmF1bHRcIl0ucmVnaXN0ZXIoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5hY3Rpb24sbj12b2lkIDA7c3dpdGNoKHQuYWN0aW9uVHlwZSl7Y2FzZSBfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQ29uc3RhbnRzMltcImRlZmF1bHRcIl0uQUdFTkNJRVNfU0VUOm49dC5hZ2VuY2llcyxfYWdlbmNpZXM9bixfYWdlbmN5Q29sb3JTY2FsZS5kb21haW4oX2FnZW5jaWVzLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZS5wcm9wZXJ0aWVzLnNsdWd9KSksQWdlbmN5U3RvcmUuZW1pdENoYW5nZSgpfXJldHVybiEwfSl9KTtleHBvcnRzW1wiZGVmYXVsdFwiXT1BZ2VuY3lTdG9yZTsiLCJcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7XCJkZWZhdWx0XCI6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIF9vYmplY3RBc3NpZ249cmVxdWlyZShcIm9iamVjdC1hc3NpZ25cIiksX29iamVjdEFzc2lnbjI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2JqZWN0QXNzaWduKSxfZXZlbnRzPXJlcXVpcmUoXCJldmVudHNcIiksX0FwcERpc3BhdGNoZXI9cmVxdWlyZShcIi4uL2Rpc3BhdGNoZXIvQXBwRGlzcGF0Y2hlclwiKSxfQXBwRGlzcGF0Y2hlcjI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQXBwRGlzcGF0Y2hlciksX0xlYXJuaW5nQ29sbGFib3JhdGl2ZUNvbnN0YW50cz1yZXF1aXJlKFwiLi4vY29uc3RhbnRzL0xlYXJuaW5nQ29sbGFib3JhdGl2ZUNvbnN0YW50c1wiKSxfTGVhcm5pbmdDb2xsYWJvcmF0aXZlQ29uc3RhbnRzMj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9MZWFybmluZ0NvbGxhYm9yYXRpdmVDb25zdGFudHMpLENIQU5HRV9FVkVOVD1cImNoYW5nZVwiLF9zY2hvb2xzPVtdLFNjaG9vbFN0b3JlPSgwLF9vYmplY3RBc3NpZ24yW1wiZGVmYXVsdFwiXSkoe30sX2V2ZW50cy5FdmVudEVtaXR0ZXIucHJvdG90eXBlLHtnZXRBbGw6ZnVuY3Rpb24oKXtyZXR1cm4gX3NjaG9vbHN9LGVtaXRDaGFuZ2U6ZnVuY3Rpb24oKXt0aGlzLmVtaXQoQ0hBTkdFX0VWRU5UKX0sYWRkQ2hhbmdlTGlzdGVuZXI6ZnVuY3Rpb24oZSl7dGhpcy5vbihDSEFOR0VfRVZFTlQsZSl9LHJlbW92ZUNoYW5nZUxpc3RlbmVyOmZ1bmN0aW9uKGUpe3RoaXMucmVtb3ZlTGlzdGVuZXIoQ0hBTkdFX0VWRU5ULGUpfSxkaXNwYXRjaGVySW5kZXg6X0FwcERpc3BhdGNoZXIyW1wiZGVmYXVsdFwiXS5yZWdpc3RlcihmdW5jdGlvbihlKXt2YXIgdD1lLmFjdGlvbixuPXZvaWQgMDtzd2l0Y2godC5hY3Rpb25UeXBlKXtjYXNlIF9MZWFybmluZ0NvbGxhYm9yYXRpdmVDb25zdGFudHMyW1wiZGVmYXVsdFwiXS5TQ0hPT0xTX1NFVDpuPXQuc2Nob29scyxfc2Nob29scz1uLFNjaG9vbFN0b3JlLmVtaXRDaGFuZ2UoKX1yZXR1cm4hMH0pfSk7ZXhwb3J0c1tcImRlZmF1bHRcIl09U2Nob29sU3RvcmU7IiwiZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCl7dGhpcy5fZXZlbnRzPXRoaXMuX2V2ZW50c3x8e30sdGhpcy5fbWF4TGlzdGVuZXJzPXRoaXMuX21heExpc3RlbmVyc3x8dm9pZCAwfWZ1bmN0aW9uIGlzRnVuY3Rpb24oZSl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgZX1mdW5jdGlvbiBpc051bWJlcihlKXtyZXR1cm5cIm51bWJlclwiPT10eXBlb2YgZX1mdW5jdGlvbiBpc09iamVjdChlKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgZSYmbnVsbCE9PWV9ZnVuY3Rpb24gaXNVbmRlZmluZWQoZSl7cmV0dXJuIHZvaWQgMD09PWV9bW9kdWxlLmV4cG9ydHM9RXZlbnRFbWl0dGVyLEV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXI9RXZlbnRFbWl0dGVyLEV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cz12b2lkIDAsRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzPXZvaWQgMCxFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycz0xMCxFdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycz1mdW5jdGlvbihlKXtpZighaXNOdW1iZXIoZSl8fDA+ZXx8aXNOYU4oZSkpdGhyb3cgVHlwZUVycm9yKFwibiBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyXCIpO3JldHVybiB0aGlzLl9tYXhMaXN0ZW5lcnM9ZSx0aGlzfSxFdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSl7dmFyIHQsaSxuLHMscixvO2lmKHRoaXMuX2V2ZW50c3x8KHRoaXMuX2V2ZW50cz17fSksXCJlcnJvclwiPT09ZSYmKCF0aGlzLl9ldmVudHMuZXJyb3J8fGlzT2JqZWN0KHRoaXMuX2V2ZW50cy5lcnJvcikmJiF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSl7aWYodD1hcmd1bWVudHNbMV0sdCBpbnN0YW5jZW9mIEVycm9yKXRocm93IHQ7dGhyb3cgVHlwZUVycm9yKCdVbmNhdWdodCwgdW5zcGVjaWZpZWQgXCJlcnJvclwiIGV2ZW50LicpfWlmKGk9dGhpcy5fZXZlbnRzW2VdLGlzVW5kZWZpbmVkKGkpKXJldHVybiExO2lmKGlzRnVuY3Rpb24oaSkpc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTppLmNhbGwodGhpcyk7YnJlYWs7Y2FzZSAyOmkuY2FsbCh0aGlzLGFyZ3VtZW50c1sxXSk7YnJlYWs7Y2FzZSAzOmkuY2FsbCh0aGlzLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pO2JyZWFrO2RlZmF1bHQ6cz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksaS5hcHBseSh0aGlzLHMpfWVsc2UgaWYoaXNPYmplY3QoaSkpZm9yKHM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLG89aS5zbGljZSgpLG49by5sZW5ndGgscj0wO24+cjtyKyspb1tyXS5hcHBseSh0aGlzLHMpO3JldHVybiEwfSxFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyPWZ1bmN0aW9uKGUsdCl7dmFyIGk7aWYoIWlzRnVuY3Rpb24odCkpdGhyb3cgVHlwZUVycm9yKFwibGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO3JldHVybiB0aGlzLl9ldmVudHN8fCh0aGlzLl9ldmVudHM9e30pLHRoaXMuX2V2ZW50cy5uZXdMaXN0ZW5lciYmdGhpcy5lbWl0KFwibmV3TGlzdGVuZXJcIixlLGlzRnVuY3Rpb24odC5saXN0ZW5lcik/dC5saXN0ZW5lcjp0KSx0aGlzLl9ldmVudHNbZV0/aXNPYmplY3QodGhpcy5fZXZlbnRzW2VdKT90aGlzLl9ldmVudHNbZV0ucHVzaCh0KTp0aGlzLl9ldmVudHNbZV09W3RoaXMuX2V2ZW50c1tlXSx0XTp0aGlzLl9ldmVudHNbZV09dCxpc09iamVjdCh0aGlzLl9ldmVudHNbZV0pJiYhdGhpcy5fZXZlbnRzW2VdLndhcm5lZCYmKGk9aXNVbmRlZmluZWQodGhpcy5fbWF4TGlzdGVuZXJzKT9FdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVyczp0aGlzLl9tYXhMaXN0ZW5lcnMsaSYmaT4wJiZ0aGlzLl9ldmVudHNbZV0ubGVuZ3RoPmkmJih0aGlzLl9ldmVudHNbZV0ud2FybmVkPSEwLGNvbnNvbGUuZXJyb3IoXCIobm9kZSkgd2FybmluZzogcG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSBsZWFrIGRldGVjdGVkLiAlZCBsaXN0ZW5lcnMgYWRkZWQuIFVzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LlwiLHRoaXMuX2V2ZW50c1tlXS5sZW5ndGgpLFwiZnVuY3Rpb25cIj09dHlwZW9mIGNvbnNvbGUudHJhY2UmJmNvbnNvbGUudHJhY2UoKSkpLHRoaXN9LEV2ZW50RW1pdHRlci5wcm90b3R5cGUub249RXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lcixFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBpKCl7dGhpcy5yZW1vdmVMaXN0ZW5lcihlLGkpLG58fChuPSEwLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpKX1pZighaXNGdW5jdGlvbih0KSl0aHJvdyBUeXBlRXJyb3IoXCJsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb25cIik7dmFyIG49ITE7cmV0dXJuIGkubGlzdGVuZXI9dCx0aGlzLm9uKGUsaSksdGhpc30sRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe3ZhciBpLG4scyxyO2lmKCFpc0Z1bmN0aW9uKHQpKXRocm93IFR5cGVFcnJvcihcImxpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvblwiKTtpZighdGhpcy5fZXZlbnRzfHwhdGhpcy5fZXZlbnRzW2VdKXJldHVybiB0aGlzO2lmKGk9dGhpcy5fZXZlbnRzW2VdLHM9aS5sZW5ndGgsbj0tMSxpPT09dHx8aXNGdW5jdGlvbihpLmxpc3RlbmVyKSYmaS5saXN0ZW5lcj09PXQpZGVsZXRlIHRoaXMuX2V2ZW50c1tlXSx0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXImJnRoaXMuZW1pdChcInJlbW92ZUxpc3RlbmVyXCIsZSx0KTtlbHNlIGlmKGlzT2JqZWN0KGkpKXtmb3Iocj1zO3ItLSA+MDspaWYoaVtyXT09PXR8fGlbcl0ubGlzdGVuZXImJmlbcl0ubGlzdGVuZXI9PT10KXtuPXI7YnJlYWt9aWYoMD5uKXJldHVybiB0aGlzOzE9PT1pLmxlbmd0aD8oaS5sZW5ndGg9MCxkZWxldGUgdGhpcy5fZXZlbnRzW2VdKTppLnNwbGljZShuLDEpLHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lciYmdGhpcy5lbWl0KFwicmVtb3ZlTGlzdGVuZXJcIixlLHQpfXJldHVybiB0aGlzfSxFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycz1mdW5jdGlvbihlKXt2YXIgdCxpO2lmKCF0aGlzLl9ldmVudHMpcmV0dXJuIHRoaXM7aWYoIXRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcilyZXR1cm4gMD09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5fZXZlbnRzPXt9OnRoaXMuX2V2ZW50c1tlXSYmZGVsZXRlIHRoaXMuX2V2ZW50c1tlXSx0aGlzO2lmKDA9PT1hcmd1bWVudHMubGVuZ3RoKXtmb3IodCBpbiB0aGlzLl9ldmVudHMpXCJyZW1vdmVMaXN0ZW5lclwiIT09dCYmdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnModCk7cmV0dXJuIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKFwicmVtb3ZlTGlzdGVuZXJcIiksdGhpcy5fZXZlbnRzPXt9LHRoaXN9aWYoaT10aGlzLl9ldmVudHNbZV0saXNGdW5jdGlvbihpKSl0aGlzLnJlbW92ZUxpc3RlbmVyKGUsaSk7ZWxzZSBpZihpKWZvcig7aS5sZW5ndGg7KXRoaXMucmVtb3ZlTGlzdGVuZXIoZSxpW2kubGVuZ3RoLTFdKTtyZXR1cm4gZGVsZXRlIHRoaXMuX2V2ZW50c1tlXSx0aGlzfSxFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycz1mdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gdD10aGlzLl9ldmVudHMmJnRoaXMuX2V2ZW50c1tlXT9pc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1tlXSk/W3RoaXMuX2V2ZW50c1tlXV06dGhpcy5fZXZlbnRzW2VdLnNsaWNlKCk6W119LEV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudD1mdW5jdGlvbihlKXtpZih0aGlzLl9ldmVudHMpe3ZhciB0PXRoaXMuX2V2ZW50c1tlXTtpZihpc0Z1bmN0aW9uKHQpKXJldHVybiAxO2lmKHQpcmV0dXJuIHQubGVuZ3RofXJldHVybiAwfSxFdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudD1mdW5jdGlvbihlLHQpe3JldHVybiBlLmxpc3RlbmVyQ291bnQodCl9OyJdfQ==
